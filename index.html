<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pengantaran Andaria</title>

  <!-- Bootstrap & Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

  <!-- Firebase & ScrollReveal -->
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore-compat.js"></script>
  <script src="https://unpkg.com/scrollreveal"></script>

  <style>
    /* ---------- GLOBAL ---------- */
    :root{
      --text:#f0f0f0; --border:#444;
      --primary:#00ff99; --accent:#00ffff;
      --neon:0 0 6px #0ff,0 0 12px #0ff;
    }
    body,html{
      margin:0;padding:0;font-family:'Segoe UI',sans-serif;color:var(--text);
      background:linear-gradient(-45deg,#8e2de2,#4a00e0,#ff6ec4,#8e2de2);
      background-size:600% 600%;animation:grad 15s ease infinite;
      scroll-behavior:smooth;
    }
    @keyframes grad{0%{background-position:0 50%}50%{background-position:100% 50%}100%{background-position:0 50%}}

    /* ---------- HEADER PARALLAX ---------- */
    .parallax{
      background:url('https://images.unsplash.com/photo-1529921879218-dc2c89f6f10f?auto=format&fit=crop&w=1350&q=80') center/cover fixed;
      min-height:250px;display:flex;align-items:center;justify-content:center;
    }
    .parallax h1{
      background:rgba(0,0,0,.6);padding:1rem 1.5rem;border-radius:12px;
      font-size:1.8rem;text-shadow:var(--neon);
      animation:glow 2s ease-in-out alternate infinite,fadeUp .8s ease-out;
    }
    @keyframes glow{from{text-shadow:0 0 4px #0ff}to{text-shadow:var(--neon)}}
    @keyframes fadeUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:none}}

    /* ---------- MAIN LAYOUT ---------- */
    .content{max-width:600px;margin:auto;padding:2rem}
    label{margin-top:.8rem}
    input,select{
      width:100%;padding:10px;border-radius:8px;background:rgba(0,0,0,.35);
      border:1px solid #888;color:#fff;font-size:1rem
    }
    input::placeholder{color:#ccc}
    input:focus{outline:none;border-color:#66ffe0;box-shadow:0 0 8px #66ffe0}

    .btn-neon{
      width:100%;padding:12px;margin-top:1rem;font-weight:bold;border:none;border-radius:32px;
      background:linear-gradient(90deg,#00ff99,#00ffff);color:#000;box-shadow:0 0 12px #0ff;transition:.3s
    }
    .btn-neon:hover{transform:scale(1.05);box-shadow:0 0 20px #0ff}

    /* ---------- TABLE ---------- */
    table{width:100%;margin-top:1rem;border-collapse:collapse;background:rgba(0,0,0,.25)}
    th,td{padding:8px;border-bottom:1px solid var(--border)}
    th{background:rgba(0,0,0,.5)}
    .delete-btn{color:#ff4d4d;cursor:pointer;transition:.3s;font-size:1.2rem}
    .delete-btn:hover{transform:scale(1.25) rotate(-10deg);text-shadow:0 0 8px red}

    /* ---------- MODAL ---------- */
    #deleteModal{
      position:fixed;inset:0;background:rgba(0,0,0,.7);
      display:none;align-items:center;justify-content:center;z-index:1000
    }
    .modal-box{
      background:#1e1e2f;width:90%;max-width:320px;padding:1.5rem;border-radius:14px;text-align:center;
      box-shadow:0 0 15px #ff6ec4
    }
    .modal-box p{margin-bottom:1.2rem}
    .modal-btn{padding:.6rem 1.2rem;border:none;border-radius:8px;font-weight:bold;cursor:pointer;margin:.2rem}
    .modal-yes{background:#ff0066;color:#fff}
    .modal-no{background:#666;color:#fff}
  </style>
</head>
<body>

  <!-- Header -->
  <div class="parallax"><h1 class="sr-header">Pengantaran Andaria</h1></div>

  <!-- Content -->
  <div class="content">
    <!-- Form -->
    <form id="form">
      <label>Nama Supir</label><input id="driver" placeholder="Contoh: Budi">
      <label>Plat Mobil</label><input id="plate" placeholder="KB 1234 XY">
      <label>Rute</label><input id="route" placeholder="Pontianak ‚Üí Sambas">
      <label>Tanggal</label><input id="date" type="date">
      <button type="submit" class="btn-neon">+ Simpan Pengantaran</button>
    </form>

    <!-- Search -->
    <input id="search" class="mt-3" placeholder="üîç Cari nama supir atau tanggal...">

    <!-- Table -->
    <table>
      <thead><tr><th>Supir</th><th>Plat</th><th>Rute</th><th>Tanggal</th><th>‚úîÔ∏è</th><th>üóëÔ∏è</th></tr></thead>
      <tbody id="data-body"></tbody>
    </table>
  </div>

  <!-- Modal -->
  <div id="deleteModal">
    <div class="modal-box">
      <p>Yakin ingin menghapus pengantaran ini?</p>
      <button id="yesDelete" class="modal-btn modal-yes">Ya, Hapus</button>
      <button id="noDelete" class="modal-btn modal-no">Batal</button>
    </div>
  </div>

<script>
/* ---------- Firebase ---------- */
const firebaseConfig={
  apiKey:"AIzaSyCvyxjv9odhKVtL6u3Jjls70Jhui-yxGSo",
  authDomain:"pengantaran-andaria.firebaseapp.com",
  projectId:"pengantaran-andaria",
  storageBucket:"pengantaran-andaria.appspot.com",
  messagingSenderId:"501077706231",
  appId:"1:501077706231:web:51c1b456fe3c1d18e11af2"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();
const deliveries=db.collection("pengantaran");

/* ---------- Helpers ---------- */
const today=new Date().toISOString().split("T")[0];
document.getElementById("date").value=today;
const platCache={};

/* Auto-fill plat */
document.getElementById("driver").addEventListener("blur",e=>{
  const name=e.target.value.trim().toLowerCase();
  if(platCache[name]) document.getElementById("plate").value=platCache[name];
});

/* Submit */
document.getElementById("form").addEventListener("submit",async e=>{
  e.preventDefault();
  const nama=document.getElementById("driver").value.trim();
  const plat=document.getElementById("plate").value.trim();
  const rute=document.getElementById("route").value.trim();
  const tanggal=document.getElementById("date").value;
  if(!nama||!plat||!rute||!tanggal) return alert("Lengkapi data!");
  platCache[nama.toLowerCase()]=plat;
  await deliveries.add({nama,plat,rute,tanggal,dicek:false,dibuat:new Date()});
  e.target.reset();document.getElementById("date").value=today;
});

/* Render rows */
function rowHtml(id,d){
  return `<tr>
    <td>${d.nama}</td><td>${d.plat}</td><td>${d.rute}</td><td>${d.tanggal}</td>
    <td style="text-align:center"><input type="checkbox" ${d.dicek?'checked':''} data-id="${id}" class="chk"></td>
    <td style="text-align:center"><i class="fas fa-trash delete-btn" data-id="${id}"></i></td>
  </tr>`;
}
function loadDaily(){
  deliveries.where("tanggal","==",today).orderBy("dibuat","desc").onSnapshot(snap=>{
    const body=document.getElementById("data-body");body.innerHTML="";
    snap.forEach(doc=>body.insertAdjacentHTML("beforeend",rowHtml(doc.id,doc.data())));
  })
}
loadDaily();

/* Search all */
document.getElementById("search").addEventListener("input",async e=>{
  const q=e.target.value.toLowerCase();
  const body=document.getElementById("data-body");body.innerHTML="";
  (await deliveries.get()).forEach(doc=>{
    const d=doc.data();
    if(d.nama.toLowerCase().includes(q)||d.tanggal.includes(q))
      body.insertAdjacentHTML("beforeend",rowHtml(doc.id,d));
  })
});

/* Checkbox & delete */
document.addEventListener("change",e=>{
  if(e.target.classList.contains("chk")){
    deliveries.doc(e.target.dataset.id).update({dicek:e.target.checked});
  }
});

/* Modal delete */
let deleteId=null;
document.addEventListener("click",e=>{
  if(e.target.classList.contains("delete-btn")){
    deleteId=e.target.dataset.id;
    document.getElementById("deleteModal").style.display="flex";
  }
});
document.getElementById("yesDelete").onclick=()=>{
  if(deleteId) deliveries.doc(deleteId).delete();
  closeModal();
};
document.getElementById("noDelete").onclick=closeModal;
function closeModal(){deleteId=null;document.getElementById("deleteModal").style.display="none";}

/* ScrollReveal animations */
ScrollReveal().reveal('.sr-header',{delay:200,distance:'40px',origin:'top',duration:1000});
ScrollReveal().reveal('.content',{delay:300,distance:'40px',origin:'bottom',duration:1200});
</script>
</body>
</html>
